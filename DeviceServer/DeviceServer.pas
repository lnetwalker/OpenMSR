program DeviceServer;

uses PhysMach,webserver,cthreads,classes,crt;

{ $Id$ }

{ This software is copyright (c) 2008 by Hartmut Eilers <hartmut@eilers.net> 	}
{ It is distributed under the terms of the GNU GPL V2 see http://www.gnu.org 	}

{ 20.02.2008		Start of project					}

type
	TWebserverThread = class(TThread)
	protected
	public
	procedure execute; override;
	end;

var
	WebThread :	TWebserverThread;

const
	Forever=false;

procedure TWebserverThread.execute;
begin
	{ start the webserver with IP, Port, Document Root and Logfile }
	//start_server('127.0.0.1',10080,'./docroot/','./pwserver.log');
	{ register special URL for content generated by this program }
	//SetupSpecialURL('/status/index.html',@embeddedWeb );
	//SetupVariableHandler(@embeddedWebReadParams);

	while not self.terminated do begin
		serve_request;
		delay(100);
	end;
end;



begin
	WebThread:=TWebserverThread.create(false);
	WebThread.freeOnTerminate:=true;

	repeat
	until Forever=true;

end.
